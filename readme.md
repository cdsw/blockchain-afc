This repo is supposed to be private, but since it is not trivial to comprehend, then I made it public.